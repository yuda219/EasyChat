<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Chat">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <title>Quick Chat</title>

    <script>
        // This forces the icon to be generated instantly by the browser
        const iconSVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect width="512" height="512" rx="100" fill="#25D366"/><path d="M256.6 76c-99 0-179.3 80.3-179.3 179.3 0 31.6 8.2 62.4 23.9 89.6L79 457l115.3-30.2c26.1 14.2 56 21.8 86.3 21.8 99 0 179.3-80.3 179.3-179.3 0-99-80.3-179.3-179.3-179.3zm99.8 251c-4.2 11.7-24.3 21.5-33.3 22-9.4.5-20.7 2.3-64.8-15.1-55.7-22-92-79.6-94.7-83.3-2.8-3.7-22.7-30.2-22.7-57.6 0-27.2 14.1-40.6 19.1-46.1 4.5-5 9.7-6.2 13-6.2 3.3 0 6.6.1 9.4.2 3 .1 7 .5 10.5 8.9 3.8 9.2 13 31.8 14.1 34.1 1.1 2.3 1.9 5 0 8.7-1.8 3.7-2.7 6-5.3 9.1-2.8 3.3-5.9 7.3-8.4 9.4-2.7 2.3-5.5 4.8-2.4 10.2 3.1 5.4 13.9 22.9 29.8 37.1 20.6 18.3 37.9 24 43.3 26.6 5.4 2.6 8.6 2.2 11.8-1.5 3.3-3.7 14.1-16.4 17.9-22 3.8-5.6 7.6-4.7 12.7-2.8 5.2 1.9 32.8 15.4 38.4 18.2 5.6 2.8 9.4 4.2 10.7 6.6 1.4 2.3 1.4 13.5-2.8 25.2z" fill="white"/></svg>`;
        const iconUrl = "data:image/svg+xml;base64," + btoa(iconSVG);
        
        // Apply icon to iOS and Browser
        let link = document.createElement('link'); link.rel = 'apple-touch-icon'; link.href = iconUrl; document.head.appendChild(link);
        let link2 = document.createElement('link'); link2.rel = 'icon'; link2.type = 'image/svg+xml'; link2.href = iconUrl; document.head.appendChild(link2);

        // Apply icon to Android Manifest dynamically
        const manifest = {
            "name": "QuickChat",
            "short_name": "QuickChat",
            "display": "standalone",
            "background_color": "#111b21",
            "theme_color": "#111b21",
            "start_url": "./index.html",
            "icons": [{ "src": iconUrl, "sizes": "512x512", "type": "image/svg+xml" }]
        };
        let manLink = document.createElement('link'); manLink.rel = 'manifest'; 
        manLink.href = 'data:application/manifest+json;charset=utf-8,' + encodeURIComponent(JSON.stringify(manifest));
        document.head.appendChild(manLink);
    </script>

    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #111b21;
            color: white; margin: 0; height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            overflow: hidden; 
        }
        .card { width: 88%; max-width: 340px; text-align: center; }
        .icon-display { width: 70px; height: 70px; margin-bottom: 20px; filter: drop-shadow(0 4px 12px rgba(0,0,0,0.3)); }
        
        h1 { font-size: 24px; margin: 0 0 10px 0; font-weight: 600; }
        p { color: #8696a0; margin: 0 0 30px 0; font-size: 15px; }
        
        .input-row { display: flex; gap: 10px; margin-bottom: 20px; }
        input {
            background: #202c33; border: 1px solid #2a3942; color: white;
            font-size: 18px; border-radius: 12px; padding: 14px; outline: none; transition: 0.2s;
        }
        input:focus { border-color: #00a884; }
        #code { width: 75px; text-align: center; color: #00a884; font-weight: bold; }
        #phone { flex: 1; }

        .action-btn {
            width: 100%; background: #00a884; color: #111b21;
            font-size: 18px; font-weight: 700; padding: 16px;
            border: none; border-radius: 12px; cursor: pointer;
        }
        .action-btn:active { opacity: 0.9; transform: scale(0.98); }
    </style>
</head>
<body>
    <div class="card">
        <svg class="icon-display" viewBox="0 0 512 512"><rect width="512" height="512" rx="100" fill="#25D366"/><path d="M256.6 76c-99 0-179.3 80.3-179.3 179.3 0 31.6 8.2 62.4 23.9 89.6L79 457l115.3-30.2c26.1 14.2 56 21.8 86.3 21.8 99 0 179.3-80.3 179.3-179.3 0-99-80.3-179.3-179.3-179.3zm99.8 251c-4.2 11.7-24.3 21.5-33.3 22-9.4.5-20.7 2.3-64.8-15.1-55.7-22-92-79.6-94.7-83.3-2.8-3.7-22.7-30.2-22.7-57.6 0-27.2 14.1-40.6 19.1-46.1 4.5-5 9.7-6.2 13-6.2 3.3 0 6.6.1 9.4.2 3 .1 7 .5 10.5 8.9 3.8 9.2 13 31.8 14.1 34.1 1.1 2.3 1.9 5 0 8.7-1.8 3.7-2.7 6-5.3 9.1-2.8 3.3-5.9 7.3-8.4 9.4-2.7 2.3-5.5 4.8-2.4 10.2 3.1 5.4 13.9 22.9 29.8 37.1 20.6 18.3 37.9 24 43.3 26.6 5.4 2.6 8.6 2.2 11.8-1.5 3.3-3.7 14.1-16.4 17.9-22 3.8-5.6 7.6-4.7 12.7-2.8 5.2 1.9 32.8 15.4 38.4 18.2 5.6 2.8 9.4 4.2 10.7 6.6 1.4 2.3 1.4 13.5-2.8 25.2z" fill="white"/></svg>
        <h1>Direct Chat</h1>
        <p>Send without saving</p>
        <div class="input-row">
            <input type="tel" id="code" value="972">
            <input type="tel" id="phone" placeholder="Phone Number" autofocus>
        </div>
        <button class="action-btn" onclick="openChat()">Open WhatsApp</button>
    </div>

    <script>
        const codeInput = document.getElementById('code');
        const phoneInput = document.getElementById('phone');

        window.onload = () => {
            const savedCode = localStorage.getItem('wa_code');
            if (savedCode) codeInput.value = savedCode;
        };

        function openChat() {
            let code = codeInput.value.replace(/[^0-9]/g, '');
            let phone = phoneInput.value.trim();
            localStorage.setItem('wa_code', code);
            
            if (phone.startsWith('+')) phone = phone.replace(/[^0-9]/g, '');
            else if (phone.startsWith('0')) phone = code + phone.substring(1).replace(/[^0-9]/g, '');
            else phone = code + phone.replace(/[^0-9]/g, '');
            
            if (phone.length < 5) return;
            window.location.href = `https://wa.me/${phone}`;
        }
        
        phoneInput.addEventListener("keypress", (e) => { if (e.key === "Enter") openChat(); });
    </script>
</body>
</html>
